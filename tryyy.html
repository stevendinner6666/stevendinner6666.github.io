<html>
    <head>
        <title>
            try to do a HTML
        </title> 
        <link rel="stylesheet" href="./cs.css">
    </head> 
<body>
    <div id="ooops">
    <p id="cin"> 2048 </p>
    </div>
    <div id="board">
        <!-- 這裡將會渲染遊戲棋盤 -->
      </div>
    
      <div id="score">
        Score: 0
      </div> 
    <script>
    const boardSize = 4;
let board = [];
let score = 0;

function initializeBoard() {
  for (let i = 0; i < boardSize; i++) {
    board[i] = [];
    for (let j = 0; j < boardSize; j++) {
      board[i][j] = 0;
    }
  }
}

function startGame() {
  initializeBoard();
  addTile();
  addTile();
  renderBoard();
}

function moveAndMergeTiles() {
    let isBoardChanged = false;
  
    // 移動磚塊
    for (let row = 0; row < boardSize; row++) {
      for (let col = 0; col < boardSize; col++) {
        if (board[row][col] !== 0) {
          let currentTile = board[row][col];
          let newRow = row;
          let newCol = col;
  
          while (newRow > 0 && board[newRow - 1][col] === 0) {
            board[newRow][col] = board[newRow - 1][col];
            board[newRow - 1][col] = currentTile;
            newRow--;
            isBoardChanged = true;
          }
        }
      }
    }
  
    // 合併磚塊
    for (let row = 0; row < boardSize - 1; row++) {
      for (let col = 0; col < boardSize; col++) {
        if (board[row][col] === board[row + 1][col]) {
          let mergedValue = board[row][col] + board[row + 1][col];
          board[row][col] = mergedValue;
          board[row + 1][col] = 0;
          updateScore(mergedValue);
          isBoardChanged = true;
        }
      }
    }
  
    return isBoardChanged;
  }
  

function addTile() {
  const emptyCells = [];
  for (let row = 0; row < boardSize; row++) {
    for (let col = 0; col < boardSize; col++) {
      if (board[row][col] === 0) {
        emptyCells.push({ row, col });
      }
    }
  }

  if (emptyCells.length > 0) {
    const randomCell = emptyCells[Math.floor(Math.random() * emptyCells.length)];
    const newValue = Math.random() < 0.9 ? 2 : 4;
    board[randomCell.row][randomCell.col] = newValue;
  }
}

function renderBoard() {
  const boardElement = document.getElementById('board');
  boardElement.innerHTML = '';

  for (let row = 0; row < boardSize; row++) {
    for (let col = 0; col < boardSize; col++) {
      const tile = document.createElement('div');
      tile.className = 'tile';
      tile.textContent = board[row][col] !== 0 ? board[row][col] : '';
      boardElement.appendChild(tile);
    }
  }
}

function updateScore(points) {
  score += points;
  document.getElementById('score').innerText = score;
}

document.addEventListener('keydown', function (event) {
  if (event.key === 'ArrowUp') {
    moveUp();
  } else if (event.key === 'ArrowDown') {
    moveDown();
  } else if (event.key === 'ArrowLeft') {
    moveLeft();
  } else if (event.key === 'ArrowRight') {
    moveRight();
  }
});

function moveUp() {
  const isBoardChanged = moveAndMergeTiles();
  if (isBoardChanged) {
    addTile();
    renderBoard();
    checkGameOver();
  }
}

function moveDown() {
  rotateBoardClockwise();
  rotateBoardClockwise();
  const isBoardChanged = moveAndMergeTiles();
  if (isBoardChanged) {
    addTile();
    renderBoard();
    checkGameOver();
  }
  rotateBoardClockwise();
  rotateBoardClockwise();
}

function moveLeft() {
  rotateBoardClockwise();
  rotateBoardClockwise();
  rotateBoardClockwise();
  const isBoardChanged = moveAndMergeTiles();
  if (isBoardChanged) {
    addTile();
    renderBoard();
    checkGameOver();
  }
  rotateBoardClockwise();
}

function moveRight() {
  rotateBoardClockwise();
  const isBoardChanged = moveAndMergeTiles();
  if (isBoardChanged) {
    addTile();
    renderBoard();
    checkGameOver();
  }
  rotateBoardClockwise();
  rotateBoardClockwise();
  rotateBoardClockwise();
}

function rotateBoardClockwise() {
  const newBoard = [];

  for (let col = 0; col < boardSize; col++) {
    newBoard[col] = [];
    for (let row = boardSize - 1; row >= 0; row--) {
      newBoard[col].push(board[row][col]);
    }
  }

  board = newBoard;
}

function checkGameOver() {
  // 檢查遊戲是否結束
}

function checkWin() {
  // 檢查是否達到 2048 的磚塊
}

function checkMoveAvailable() {
  // 檢查是否還有可移動的空間
}

// 在這裡調用 startGame() 或其他開始遊戲的函式
startGame();
</script>
    <div id="oops">
    <p id="my-text"></p>
    </div>
    <h1 class="h1class">stevendinner6666 is here</h1>
    <a href="https://www.instagram.com/stevendinner6666/">>>instagram</a>
    <p></p>
    <a href="https://www.facebook.com/profile.php?id=100012712602980">>>facebook</a>
    <script>function displayText() {
    var textDisplay = document.getElementById("my-text");
    
    textDisplay.innerHTML = "Hello";
    setTimeout(function() {
      textDisplay.innerHTML = "user";
      setTimeout(function() {
        textDisplay.innerHTML = "你好";
        setTimeout(function(){
        textDisplay.innerHTML = "你是帥哥嗎？";
        setTimeout(function(){
        textDisplay.innerHTML = "看來不是";
        setTimeout(function(){textDisplay.innerHTML = "你是美女嗎？";
        setTimeout(function(){textDisplay.innerHTML = "看來也不是";
        setTimeout(function(){displayText();
        },1000);
        },1000);
        },1000);
        },1000);
        },1000);
      }, 1000);
    }, 1000);
  }
  
  displayText();
  </script>
     
        <script src="https://code.jquery.com/jquery-3.7.0.js" integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=" crossorigin="anonymous"></script>
   
        <script src="./first.js"></script>

    
</body>
   
</html>